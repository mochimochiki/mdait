## 重要

### 必須事項

- チケット発行時は設計ガイドラインに従う
- 実装開始時は実装ガイドラインに従う
- テスト実装時はテストガイドラインに従う

### 設計ガイドライン

タスクチケット（taskチケット）発行を求められた場合や実装をすぐに始められるほどの明確な指示でない場合、まずは設計を行ってください。`design/design.md`を参照して関連する事項を確認し、ユーザーと対話しながら設計を行ってください。

- 設計の概要をチャットに出力する場合、コードは必要最小限にとどめること。
- チャットでは詳細な設計よりも、設計の方針や骨子・会話を重視してください。
- 方針・骨子がまとまってきたら、まとまった変更や新機能については適宜`design.md`を修正してください。
  - 要点を簡潔に書くことを心がけること。設計の変更はユーザーに承認を得てから行ってください。
- `design.md`の詳細設計は、`tasks/do/yymmdd_<作業名>.md`に作業チケットとして記載してください。yymmdd は今日の日付をもとにしてください。ファイル名は日本語で作業概要がよくわかるように簡潔に記載してください。
- 作業チケットは簡潔に。おおむね100行以内・1500文字以内で。疑似コードは使っていいが、細部は記載せず処理概要を伝えるのみにしてください。
- mermaid記法を使用して、図や表を記載し、設計をわかりやすくすることを推奨します。
- 承認が得られたら実装に進んでください。実装完了時には`tasks/do`から`tasks/done`にファイルを移し、設計との整合性チェックおよび実装時のメモを記載してください。
- 以下のフォーマットに従ってください。
```markdown
# 作業チケット: <作業名>

## 1. 概要と方針

（概要と方針を簡潔に記載）

## 2. 主な処理フロー

（mermaidシーケンス図を使用。重要な処理を明示。適宜rectによるフェーズ分け）

## 3. 主要関数・モジュール

（代表的なものに絞り、簡潔に記載）

## 4. 考慮事項

（特に注意が必要な点や考慮すべき点、チェックすべき影響範囲などを記載）

## 5. 実装計画と進捗

（実装項目の細目を以下のタスクの形で記載。実装後にチェックをつけていく）
- [ ] <未完了タスク名>
- [x] <完了タスク名>

## 6. 実装メモ・テスト観点

（各タスクの実装完了時に気づきやテスト観点を記載）

```

### 実装ガイドライン

実装を開始するのに十分な設計が行われていれば、ユーザーから実装の承認が得て、実装を開始してください。このガイドラインを読んだことを示すために、`実装ガイドラインに従い実装します。`と出力してから作業してください。

- 実装を始める際は既存のコード構造を確認して、周りのコードにスタイルを合わせてください。あまりにレガシーだったり書き方として今いちである場合は除く。その場合でも既存コードは勝手にリファクタリングはしないこと）
- `design/design.md`や`tasks/do/<作業名>.md`を参照して、設計に従って実装を行ってください。
- Node.jsのbuildinモジュールのimportでは`node:`を使用してください。
- ユーザーから指示されていない機能や要件について実装を推奨する場合は必ず承認を得るようにしてください。勝手に実装はしないでください。
- 利用できるパッケージに注意してください。`package.json`に記載されています。新しいパッケージを追加する場合は、ユーザーに承認を得てください。まずは既存パッケージで実装できないか確認してください。
- 実装完了時には、`tasks/do`から`tasks/done`にファイルを移し、設計との整合性チェックおよび実装時のメモを記載してください。`design.md`の内容と整合性が取れているか確認してください。必要に応じて`design.md`も更新してください。

### テストガイドライン

テスト実装時にはこのガイドラインに従ってください。テストの実行は`npm test`で行えます。テスト実装前にこのガイドラインを読んだことを示すために、`テストガイドラインに従いテスト実装します。`と出力してください。

- 実装する際は、周りのコードにスタイルを合わせてください。（あまりにレガシーだったり書き方として今いちである場合は除く。その場合でも既存コードは勝手にリファクタリングはしないこと）
- Node.jsのbuildinモジュールのimportでは`node:`を使用してください。
- テストは`src\test`以下に、`src`以下のディレクトリ構造と対応づくように実装してください。
- テスト名は日本語で記述してください。

- `mocha`
  - 明示的importは不要なので**記載しないで**ください。
  - TDDスタイルを使用してください。BDDスタイルは使用しないでください。
  - `suite`と`test`を使用してください。`describe`や`it`は使用しないでください。
