## 重要

### 設計

実装をすぐに始められるほどの明確な指示でない場合、まずは設計を行ってください。

- `design.md`を参照して関連する事項を確認し、ユーザーと対話しながら設計を行ってください。
  - 設計の概要をチャットに出力する場合、コードは必要最小限にとどめること。
  - チャットでは詳細な設計よりも、設計の方針や骨子・会話を重視してください。
- 方針・骨子がまとまってきたら、まとまった変更や新機能については適宜`design.md`を修正してください。
  - 要点を簡潔に書くことを心がけること。設計の変更はユーザーに承認を得てから行ってください。
- `design.md`の詳細設計は、`tasks/do/<作業名>.md`に作業チケットとして記載してください。ファイル名は日本語で作業概要がよくわかるように簡潔に記載してください。
  - 作業チケットは簡潔に。おおむね100行以内・1500文字以内で。疑似コードは使っていいが、細部は記載せず処理概要を伝えるのみにしてください。
  - mermaid記法を使用して、図や表を記載し、設計をわかりやすくすることを推奨します。
  - 承認が得られたら実装に進んでください。実装完了時には`tasks/do`から`tasks/done`にファイルを移し、設計との整合性チェックおよび実装時のメモを記載してください。
  - 以下のフォーマットに従ってください。
    - `# 作業チケット: <作業名>`
    - `## 1. 概要と方針`（概要と方針を簡潔に記載）
    - `## 2. 主な処理フロー`（mermaid記法を使用）
    - `## 3. 主要関数・モジュール` (代表的なものに絞り、簡潔に記載)
    - `## 4. 考慮事項`（特に注意が必要な点や考慮すべき点、チェックすべき影響範囲などを記載）
    - `## 5. 実装計画と進捗`（実装項目の細目を以下のタスクの形で記載。実装後にチェックをつけていく）
      - `- [ ] <未完了タスク名>`
      - `- [x] <完了タスク名>`
    - `## 6. 実装メモ・テスト観点`（各タスクの実装完了時に気づきやテスト観点を記載）
    - `## 7. 次のステップ`（次に行うべきことを記載）

### 実装

実装を開始するのに十分な設計が行われていれば、ユーザーから実装の承認が得て、実装を開始してください。

- 実装する際は、周りのコードにスタイルを合わせてください。（あまりにレガシーだったり書き方として今いちである場合は除く。その場合でも既存コードは勝手にリファクタリングはしないこと）
- `design.md`や`tasks/do/<作業名>.md`を参照して、設計に従って実装を行ってください。
- `@important`のコメントがある場合は、必ず確認して指示を順守してください。適切と思われる場合ユーザーにその指示に従ったことを明示してください。
- Node.jsのbuildinモジュールのimportでは`node:`を使用してください。
- 実装中に`design.md`に示されていない設計方針の選択があった場合は一度立ち止まり、ユーザーに確認を行ってください。`design.md`に反映を行う場合もユーザーに承認を得てください。
- ユーザーから指示されていない機能や要件について実装を推奨する場合は必ず承認を得るようにしてください。勝手に実装はしないでください。
- 利用できるパッケージに注意してください。`package.json`に記載されています。新しいパッケージを追加する場合は、ユーザーに承認を得てください。まずは既存パッケージで実装できないか確認してください。
- 実装完了時には、`tasks/do`から`tasks/done`にファイルを移し、設計との整合性チェックおよび実装時のメモを記載してください。`design.md`の内容と整合性が取れているか確認してください。必要に応じて`desin .md`も更新してください。

### テスト

テスト実装時にはこのガイドラインに従ってください。テストの実行は`npm test`で行えます。

- テスト実装前にこのガイドラインを読んだことを示すために、`テストガイドラインに従いテスト実装します。`と出力してください。
- 実装する際は、周りのコードにスタイルを合わせてください。（あまりにレガシーだったり書き方として今いちである場合は除く。その場合でも既存コードは勝手にリファクタリングはしないこと）
- Node.jsのbuildinモジュールのimportでは`node:`を使用してください。
- テストは`src\test`以下に、`src`以下のディレクトリ構造と対応づくように実装してください。
- テスト名は日本語で記述してください。

- `mocha`
  - 明示的importは不要なので**記載しないで**ください。
  - TDDスタイルを使用してください。BDDスタイルは使用しないでください。
  - `suite`と`test`を使用してください。`describe`や`it`は使用しないでください。

### コミットメッセージ

- メソッド/クラス/変数名や設計用語などは英語で記述してください。
- 説明文は日本語で記述してください。
- <概要>は、何の機能に対するどういう目的の変更かを簡潔に記述してください。
- <変更内容>は抽象的な書き方をせず具体的に何を変更したのか記述してください。
- 軽微な変更は省略してください。
- コミットメッセージは以下の形式で150文字以内で記述してください。
  - `feat: <概要> <変更内容>`
  - `fix: <概要> <変更内容>`
  - `refactor: <概要> <変更内容>`
  - `test: <概要> <変更内容>`
  - `docs: <概要> <変更内容>`