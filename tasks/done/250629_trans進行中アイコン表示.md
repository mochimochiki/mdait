# 作業チケット: trans進行中アイコン表示

## 1. 概要と方針
Statusツリーでtransコマンド実行中、該当StatusItemのアイコンをprogress（$(sync~spin)等）表示にする。StatusItemごとに進行中状態を持たせ、transコマンドの開始・終了で状態を切り替える。

## 2. 主な処理フロー
```mermaid
flowchart TD
  ユーザー操作 -->|transコマンド| StatusTreeTranslationHandler
  StatusTreeTranslationHandler -->|対象StatusItem取得| StatusItem
  StatusItem -->|isTranslating=true| StatusTreeProvider
  StatusTreeProvider -->|refresh(item)| VSCodeツリー
  trans完了/失敗 -->|isTranslating=false| StatusTreeProvider
```

## 3. 主要関数・モジュール
- StatusItem: isTranslatingプロパティ追加
- StatusTreeProvider: getTreeItemでisTranslating時にprogressアイコン返却、refresh(item)対応
- StatusTreeTranslationHandler: transコマンド実行時に状態切替

## 4. 考慮事項
- 複数同時実行時の排他制御（StatusItem単位で管理）
- 例外発生時も状態復旧（try/finally）
- 状態変更時は該当ノードのみrefresh
- アイコンはVSCode標準の$(sync~spin)等を利用

## 5. 実装計画と進捗
- [x] StatusItemにisTranslating追加
- [x] StatusTreeProviderのgetTreeItem修正
- [x] StatusTreeProvider.refresh(item)でfileStatusesの該当要素に状態反映
- [x] StatusTreeTranslationHandlerで状態切替実装
- [x] transコマンドの各実装で状態制御追加
- [x] テスト追加

## 6. 実装メモ・テスト観点
- 進行中状態でアイコンが即時sync~spinに変化することを確認
- 例外時も状態が戻ることを確認（try/finallyで制御）
- 複数同時実行時も各StatusItem単位で進行中表示が独立して動作
- refresh(item)時にfileStatusesの該当要素（FileStatus/UnitStatus）へisTranslatingを反映することで、UIと状態が同期
- テストでisTranslatingの有無によるアイコン切替を検証済み

## 7. 次のステップ
- tasks/doneへ移動し、設計との整合性最終確認
- 実装内容のレビュー・フィードバック対応
