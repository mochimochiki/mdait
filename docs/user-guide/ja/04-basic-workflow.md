# 基本ワークフロー

このセクションでは、mdaitを使った日常的な翻訳作業の流れについて説明します。

## ワークフローの概要

```
1. 原文を編集
    ↓
2. 同期実行（Sync）
    ↓
3. 翻訳実行（Trans）
    ↓
4. 翻訳結果の確認・修正
```

## 1. 原文の編集

通常通り原文のMarkdownファイルを編集します。mdaitマーカーは手動で編集する必要はありません。

```markdown
<!-- mdait 3f7c8a1b -->
## はじめに

mdaitは、Markdownドキュメントを継続的に多言語運用するための
VS Code拡張機能です。
```

新しいセクションを追加する場合も、通常の見出しを記述するだけです：

```markdown
<!-- mdait 3f7c8a1b -->
## はじめに

mdaitは、Markdownドキュメントを継続的に多言語運用するための
VS Code拡張機能です。

## 新しいセクション

ここに新しい内容を追加します。
```

## 2. 同期の実行

原文を編集したら、mdaitビューのツールバーから🔄（Sync）ボタンをクリックします。

### 同期で行われること

#### 原文の処理
- 新しい見出しにmdaitマーカーを自動付与
- 既存ユニットの内容ハッシュを再計算
- ユニット内容に変更があった場合、ハッシュを更新

#### 訳文の処理
- 原文に対応する訳文ファイルを作成（未作成の場合）
- 原文の新規ユニットに対応する訳文ユニットを生成し、`need:translate`を付与
- 原文が変更されたユニットの訳文に`need:revise`を付与
- 原文から削除されたユニットを処理（`autoDelete`設定による）

**ヒント**
- 訳文の手動編集は保持されます（`from`フィールドが維持されるため）
- 原文が変更されていない訳文ユニットは、そのまま維持されます

## 3. 翻訳の実行

### ユニット単位の翻訳

最も細かい単位での翻訳です。訳文ファイルを開き、mdaitマーカー上の[✨AI翻訳]ボタンをクリックします。

### ファイル単位の翻訳

ステータスツリーでファイルノードの▶️ボタンをクリックすると、そのファイル内の`need:translate`が付与されたすべてのユニットを順次翻訳します。

### ディレクトリ単位の翻訳

ステータスツリーでディレクトリノードの▶️ボタンをクリックすると、そのディレクトリ配下のすべての`need:translate`ユニットを翻訳します。
※サブディレクトリも含めて処理されます。APIの使用量に注意してください。

## 4. 翻訳結果の確認

### 翻訳サマリの表示

翻訳完了後、mdaitマーカー行の「翻訳完了」メッセージにマウスオーバーすると、翻訳サマリがホバー表示されます：

### 用語集への追加

ホバー表示された用語集追加候補をクリックすると、その用語を用語集に追加できます。

### 原文との比較

マーカー行末のインライン表示「原文」をクリックすると、原文との比較ビューが開きます。左側に原文、右側に訳文が表示され、内容を確認できます。

### 手動での修正

翻訳結果は通常のテキストとして編集できます。修正後も`from`フィールドは維持されるため、原文との対応関係は保持されます。

## 継続的な運用

### 日常的な更新サイクル

1. **原文を更新**: 新しいコンテンツの追加や既存コンテンツの修正
2. **Syncを実行**: 変更を検出し、訳文に反映
3. **翻訳を実行**: `need:translate`が付与されたユニットを翻訳
4. **レビュー**: 翻訳結果を確認し、必要に応じて修正
5. **コミット**: 原文と訳文をバージョン管理システムにコミット

### 再翻訳の強制

特定のユニットを再翻訳したい場合、mdaitマーカーに手動で`need:translate`を追加できます：

```markdown
<!-- mdait 2d5e9c4f from:3f7c8a1b need:translate -->
## Introduction
```

### 翻訳のスキップ

特定のユニットの翻訳をスキップしたい場合、`need:translate`を手動で削除できます：

```markdown
<!-- mdait 2d5e9c4f from:3f7c8a1b need:translate -->
```
↓ スキップする場合
```markdown
<!-- mdait 2d5e9c4f from:3f7c8a1b -->
```

## 次のステップ

[次の章](05-glossary-management.md)では、用語集の管理と活用方法について説明します。
